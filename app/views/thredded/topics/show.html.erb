<%= stylesheet_link_tag "1st_load_framework", media: "all", "data-turbolinks-track" => "reload" %>
<%= stylesheet_link_tag "custom", media: "all", "data-turbolinks-track" => "reload" %>

<%# navigation styled for Bootstrap 3.0 %>
<nav class="navbar navbar-inverse navbar-fixed-top">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <%= link_to 'Home', main_app.root_path, class: 'navbar-brand' %>
    </div>
    <div class="collapse navbar-collapse">
      <ul class="nav navbar-nav navbar-right">
        <%= render 'layouts/navigation_links' %>
        <%= render 'layouts/nav_links_for_auth' %>
      </ul>
    </div>
  </div>
</nav>

<!-- Page Content -->
<div class="container">
<% topic = @posts.topic %>
<% content_for :thredded_page_title, topic.title %>
<% content_for :thredded_page_id, 'thredded--topic-show' %>
<% content_for :thredded_breadcrumbs, render('thredded/shared/breadcrumbs') %>

<%= thredded_page do %>
  <%= content_tag :section,
                  id: dom_id(topic),
                  class: ['thredded--main-section', 'thredded--topic', *topic_css_classes(topic)] do %>

    <%= render 'thredded/topics/header', topic: topic %>
    <%= view_hooks.posts_common.pagination_top.render(self, posts: @posts) do %>
      <footer class="thredded--pagination-top"><%= paginate @posts %></footer>
    <% end %>
    <%= render partial: 'thredded/posts/post', collection: @posts, cached: true %>
    <%= view_hooks.posts_common.pagination_bottom.render(self, posts: @posts) do %>
      <footer class="thredded--pagination-bottom"><%= paginate @posts %></footer>
    <% end %>

    <% if policy(@new_post).create? %>
      <div class="thredded--post-form--wrapper">
        <h3 class="thredded--post-form--title">Add a post</h3>
        <%= render 'thredded/posts/form',
                   topic:       topic,
                   post:        @new_post,
                   preview_url: topic.new_post_preview_path,
                   button_text: t('thredded.posts.form.create_btn'),
                   button_submitting_text: t('thredded.posts.form.create_btn_submitting') %>
      </div>
    <% end %>

    <% if topic.can_destroy? %>
      <div class="thredded--topic-delete--wrapper">
        <%= button_to t('thredded.topics.delete_topic'), topic.destroy_path, method: :delete,
                      form_class: 'thredded--topic-delete-form',
                      class: 'thredded--button',
                      'data-confirm' => t('thredded.topics.delete_confirm') %>
      </div>
    <% end %>
  <% end %>
<% end %>
</div>
